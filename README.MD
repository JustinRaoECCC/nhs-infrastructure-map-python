NHS Infrastructure Map
A Python + Eel Desktop Mapping Tool for Infrastructure Management

ğŸ—ºï¸ Overview
NHS Infrastructure Map is a cross-platform desktop application for visualizing, managing, and editing NHS infrastructure records stored in Excel workbooks.

It uses:

Python + Eel for backend logic and desktop hosting

Leaflet.js for interactive mapping

Excel workbooks (.xlsx) for structured data storage

Designed for:
Field Engineers

Operations Managers

Maintenance Teams

This tool streamlines data entry, inspection tracking, and prioritization of repairs using a familiar desktop environment.

ğŸš€ Features
Interactive Map (Leaflet.js):
Pan, zoom, view infrastructure markers by category and priority.

Dynamic Filtering & Search:
Filter by region, asset type, or custom categories with color-coded markers.

CRUD Operations on Excel Data:
Add, edit, or remove station records directly via the app interface.

Bulk Import:
Import infrastructure data from Excel sheets with duplicate detection.

Priority Repairs View:
Focus on urgent repairs grouped by priority.

Export to PDF:
Capture map views or list views as PDF snapshots.

Safe Data Wipe (Data Nuke):
Triple-confirmation delete of Excel data files when required.

ğŸ—‚ï¸ Project Structure
yaml
Copy
Edit
nhs-infrastructure-map-python/
â”œâ”€â”€ backend/                       # Python backend logic
â”‚   â”œâ”€â”€ app.py                     # Eel startup and routing
â”‚   â”œâ”€â”€ excel_handler.py           # CRUD on Excel files
â”‚   â”œâ”€â”€ lookups_manager.py         # Lookup table management
â”‚   â”œâ”€â”€ bulk_importer.py           # Bulk import logic
â”‚   â”œâ”€â”€ export_manager.py          # PDF export tools
â”‚   â”œâ”€â”€ data_nuke.py               # Controlled data deletion logic
â”‚   â”œâ”€â”€ file_locks.py              # Mutex lock handling
â”‚   â””â”€â”€ utils.py                   # Common helper functions
â”œâ”€â”€ frontend/                      # HTML/JS/CSS frontend served by Eel
â”‚   â”œâ”€â”€ index.html                 # Main Map UI
â”‚   â”œâ”€â”€ list_view.html             # List of stations view
â”‚   â”œâ”€â”€ repairs_view.html          # Priority repairs view
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css              # Application styles
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ main.js                # App init and routing
â”‚   â”‚   â”œâ”€â”€ map_view.js            # Leaflet logic
â”‚   â”‚   â”œâ”€â”€ filters.js             # Filtering and search
â”‚   â”‚   â”œâ”€â”€ data_api.js            # JS â†” Python (Eel) bridge
â”‚   â”‚   â”œâ”€â”€ modals.js              # Modal handling (CRUD)
â”‚   â”‚   â”œâ”€â”€ list_view.js           # List view logic
â”‚   â”‚   â”œâ”€â”€ repairs_view.js        # Repairs-specific logic
â”‚   â”‚   â”œâ”€â”€ export.js              # PDF export frontend logic
â”‚   â”‚   â”œâ”€â”€ nuke.js                # Data nuke logic
â”‚   â”‚   â””â”€â”€ utils.js               # Common JS utilities
â”‚   â””â”€â”€ assets/
â”‚       â”œâ”€â”€ icons/                 # Marker icons and graphics
â”‚       â””â”€â”€ placeholder.txt
â”œâ”€â”€ data/                          # Generated Excel data files
â”‚   â”œâ”€â”€ repairs/
â”‚   â”‚   â””â”€â”€ <station>_repairs.xlsx
â”‚   â”œâ”€â”€ lookups.xlsx
â”‚   â”œâ”€â”€ <asset_type>.xlsx
â”‚   â””â”€â”€ placeholder.txt
â”œâ”€â”€ tests/                         # Python unit tests
â”œâ”€â”€ requirements.txt               # Python package list
â”œâ”€â”€ README.md                       # (This file)
â”œâ”€â”€ run.py                         # Main app runner
â””â”€â”€ setup.sh                        # (Optional) Setup script
ğŸ Dependencies
These Python packages are required and installed inside the virtual environment:

eel â€” Desktop Python + JS bridge

openpyxl â€” Excel reading/writing

pandas â€” Data manipulation and lookups

watchdog â€” File change monitoring (optional)

reportlab â€” PDF generation

Installed with:

nginx
Copy
Edit
pip install eel openpyxl pandas watchdog reportlab
ğŸ–¥ï¸ Your Daily Workflow
Step	Command
1ï¸âƒ£ Open VS Code on the network project folder	File â†’ Open Folder â†’ (select network path)
2ï¸âƒ£ Open VS Code terminal	Ctrl + `` (backtick)
3ï¸âƒ£ Activate your local virtual environment	C:\Users\RaoJ\venvs\nhs-map\venv\Scripts\activate
4ï¸âƒ£ (Optional) Use pushd in terminal if needed	pushd "\\Network\Path\To\Project"
5ï¸âƒ£ Run your app	python run.py
6ï¸âƒ£ Edit code & test	Use VS Code normally
7ï¸âƒ£ When done	deactivate or close terminal

ğŸ› ï¸ Setting Up Virtual Environment (One-Time)
1ï¸âƒ£ Create on your local machine (never on network drive):

arduino
Copy
Edit
cd C:\Users\RaoJ\venvs\
mkdir nhs-map
cd nhs-map
python -m venv venv
2ï¸âƒ£ Install dependencies:

arduino
Copy
Edit
C:\Users\RaoJ\venvs\nhs-map\venv\Scripts\activate
pip install eel openpyxl pandas watchdog reportlab
ğŸ‘¥ If Someone Else Wants to Use the App
1ï¸âƒ£ They must have Python 3.11+ installed
2ï¸âƒ£ They must create their own virtual environment on their local PC:

nginx
Copy
Edit
python -m venv venv
3ï¸âƒ£ They must install the dependencies inside their venv:

nginx
Copy
Edit
pip install eel openpyxl pandas watchdog reportlab
4ï¸âƒ£ They open VS Code, activate their venv in terminal, and navigate to:

arduino
Copy
Edit
\\Ecbcv6cwvfsp001.ncr.int.ec.gc.ca\msc$\401\WSCConstruction\Engineering_Services_West\Cableway and Facilities\Work Plan\BC\2025\Working Folders\Justin\nhs-infrastructure-map-python
5ï¸âƒ£ Run:

arduino
Copy
Edit
python run.py
âœ… They do NOT create the venv on the network folder.
âœ… Each person uses their own local venv but works on the shared code.

ğŸ“¢ Important Notes for Collaborators
No admin rights required

Always activate your own venv before running the app

Python venv is not shared â€” itâ€™s personal per user

Feel free to copy this README and personalize your setup

ğŸ“ License & Contributions
Internal project for Government of Canada engineering services.
Contact Justin Rao for questions, issues, or contributions.


C:\Users\RaoJ\venvs\nhs-map\venv\Scripts\activate